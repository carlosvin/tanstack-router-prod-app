{"version":3,"file":"books-Co_14twq.js","sources":["../../src/components/BookEntry.tsx","../../src/services/pagination.ts","../../src/components/Paginator.tsx","../../node_modules/@tanstack/pacer/dist/esm/utils.js","../../node_modules/@tanstack/devtools-event-client/dist/esm/index.js","../../node_modules/@tanstack/pacer/dist/esm/event-client.js","../../node_modules/@tanstack/pacer/dist/esm/debouncer.js","../../src/components/Search.tsx","../../src/routes/books.tsx?tsr-split=component"],"sourcesContent":["import { Link } from \"@tanstack/react-router\"\nimport type { Book } from \"@/schemas/book\"\nimport { Authors } from \"./Authors\"\n\nexport function BookEntry({ title, authors, id }: Book) {\n  return (\n    <span className=\"container-fluid grid\">\n      <Link to=\"/books/$bookId\" params={{ bookId: id.toString() }}>\n        {title}\n      </Link>\n      <small>\n        <Authors authors={authors} />\n      </small>\n    </span>\n  )\n}\n","interface PageProps {\n  page: number\n  text: string\n  isDisabled?: boolean\n}\n\ninterface PaginatorProps {\n  totalItems: number\n  currentPage: number\n  perPage: number\n}\n\nfunction getPage(\n  text: string,\n  page: number,\n  currentPage: number,\n  lastPage: number,\n): PageProps {\n  const isDisabled = page < 1 || page > lastPage || page === currentPage\n  return { text, page, isDisabled }\n}\n\nexport function getPageNumbers({\n  totalItems,\n  currentPage,\n  perPage,\n}: PaginatorProps): PageProps[] {\n  const lastPage = Math.max(1, Math.ceil(totalItems / perPage))\n  const currentPageClamped = Math.min(Math.max(1, currentPage), lastPage)\n  return [\n    getPage(\"<<\", 1, currentPageClamped, lastPage),\n    getPage(\n      \"<\",\n      Math.max(currentPageClamped - 1, 1),\n      currentPageClamped,\n      lastPage,\n    ),\n    getPage(\"\", currentPageClamped, currentPageClamped, lastPage),\n    getPage(\n      \">\",\n      Math.min(currentPageClamped + 1, lastPage),\n      currentPageClamped,\n      lastPage,\n    ),\n    getPage(\">>\", lastPage, currentPageClamped, lastPage),\n  ]\n}\n","import { getPageNumbers } from \"@/services/pagination\"\n\ninterface PaginatorProps {\n  totalItems: number\n  currentPage: number\n  perPage: number\n  onPageChange: (page: number) => void\n}\n\nexport function PaginatorButtons({\n  totalItems,\n  currentPage,\n  perPage,\n  onPageChange,\n}: PaginatorProps) {\n  return (\n    <div role=\"group\">\n      {getPageNumbers({ totalItems, currentPage, perPage }).map(\n        ({ page, text, isDisabled }) => (\n          <button\n            key={`paginator-${text}-${page}`}\n            onClick={() => onPageChange(page)}\n            disabled={isDisabled}\n            type=\"button\"\n            className=\"outline\"\n          >\n            {text} <small>({page})</small>\n          </button>\n        ),\n      )}\n    </div>\n  )\n}\n","function isFunction(value) {\n  return typeof value === \"function\";\n}\nfunction parseFunctionOrValue(value, ...args) {\n  return isFunction(value) ? value(...args) : value;\n}\nfunction createKey(key) {\n  if (key) {\n    return key;\n  }\n  if (typeof crypto !== \"undefined\" && typeof crypto.randomUUID === \"function\") {\n    return crypto.randomUUID();\n  }\n  return \"\";\n}\nexport {\n  createKey,\n  isFunction,\n  parseFunctionOrValue\n};\n//# sourceMappingURL=utils.js.map\n","import { EventClient as EventClient$1 } from \"./plugin.js\";\nclass MockClass {\n  on(_, __) {\n  }\n  onAll(_) {\n  }\n  onAllPluginEvents(_) {\n  }\n  emit(_, ...__) {\n  }\n  getPluginId() {\n  }\n}\nconst EventClient = process.env.NODE_ENV !== \"development\" && process.env.NODE_ENV !== \"test\" ? MockClass : EventClient$1;\nexport {\n  EventClient\n};\n//# sourceMappingURL=index.js.map\n","import { EventClient } from \"@tanstack/devtools-event-client\";\nclass PacerEventClient extends EventClient {\n  constructor(props) {\n    super({\n      pluginId: \"pacer\",\n      debug: props?.debug\n    });\n  }\n}\nconst emitChange = (event, payload) => {\n  pacerEventClient.emit(event, payload);\n};\nconst pacerEventClient = new PacerEventClient();\nexport {\n  emitChange,\n  pacerEventClient\n};\n//# sourceMappingURL=event-client.js.map\n","import { Store } from \"@tanstack/store\";\nimport { parseFunctionOrValue, createKey } from \"./utils.js\";\nimport { emitChange, pacerEventClient } from \"./event-client.js\";\nfunction getDefaultDebouncerState() {\n  return {\n    canLeadingExecute: true,\n    executionCount: 0,\n    isPending: false,\n    lastArgs: void 0,\n    status: \"idle\",\n    maybeExecuteCount: 0\n  };\n}\nconst defaultOptions = {\n  enabled: true,\n  leading: false,\n  trailing: true,\n  wait: 0\n};\nclass Debouncer {\n  constructor(fn, initialOptions) {\n    this.fn = fn;\n    this.store = new Store(\n      getDefaultDebouncerState()\n    );\n    this.setOptions = (newOptions) => {\n      this.options = { ...this.options, ...newOptions };\n      if (!this.#getEnabled()) {\n        this.cancel();\n      }\n    };\n    this.#setState = (newState) => {\n      this.store.setState((state) => {\n        const combinedState = {\n          ...state,\n          ...newState\n        };\n        const { isPending } = combinedState;\n        return {\n          ...combinedState,\n          status: !this.#getEnabled() ? \"disabled\" : isPending ? \"pending\" : \"idle\"\n        };\n      });\n      emitChange(\"Debouncer\", this);\n    };\n    this.#getEnabled = () => {\n      return !!parseFunctionOrValue(this.options.enabled, this);\n    };\n    this.#getWait = () => {\n      return parseFunctionOrValue(this.options.wait, this);\n    };\n    this.maybeExecute = (...args) => {\n      if (!this.#getEnabled()) return void 0;\n      this.#setState({\n        maybeExecuteCount: this.store.state.maybeExecuteCount + 1\n      });\n      let _didLeadingExecute = false;\n      if (this.options.leading && this.store.state.canLeadingExecute) {\n        this.#setState({ canLeadingExecute: false });\n        _didLeadingExecute = true;\n        this.#execute(...args);\n      }\n      if (this.options.trailing) {\n        this.#setState({ isPending: true, lastArgs: args });\n      }\n      if (this.#timeoutId) clearTimeout(this.#timeoutId);\n      this.#timeoutId = setTimeout(() => {\n        this.#setState({ canLeadingExecute: true });\n        if (this.options.trailing && !_didLeadingExecute) {\n          this.#execute(...args);\n        }\n      }, this.#getWait());\n    };\n    this.#execute = (...args) => {\n      if (!this.#getEnabled()) return void 0;\n      this.fn(...args);\n      this.#setState({\n        executionCount: this.store.state.executionCount + 1,\n        isPending: false,\n        lastArgs: void 0\n      });\n      this.options.onExecute?.(args, this);\n    };\n    this.flush = () => {\n      if (this.store.state.isPending && this.store.state.lastArgs) {\n        this.#clearTimeout();\n        this.#execute(...this.store.state.lastArgs);\n      }\n    };\n    this.#clearTimeout = () => {\n      if (this.#timeoutId) {\n        clearTimeout(this.#timeoutId);\n        this.#timeoutId = void 0;\n      }\n    };\n    this.cancel = () => {\n      this.#clearTimeout();\n      this.#setState({\n        canLeadingExecute: true,\n        isPending: false\n      });\n    };\n    this.reset = () => {\n      this.#setState(getDefaultDebouncerState());\n    };\n    this.key = createKey(initialOptions.key);\n    this.options = {\n      ...defaultOptions,\n      ...initialOptions\n    };\n    this.#setState(this.options.initialState ?? {});\n    pacerEventClient.on(\"d-Debouncer\", (event) => {\n      if (event.payload.key !== this.key) return;\n      this.#setState(event.payload.store.state);\n      this.setOptions(event.payload.options);\n    });\n  }\n  #timeoutId;\n  #setState;\n  #getEnabled;\n  #getWait;\n  #execute;\n  #clearTimeout;\n}\nfunction debounce(fn, initialOptions) {\n  const debouncer = new Debouncer(fn, initialOptions);\n  return debouncer.maybeExecute;\n}\nexport {\n  Debouncer,\n  debounce\n};\n//# sourceMappingURL=debouncer.js.map\n","import { debounce } from \"@tanstack/pacer\"\n\ninterface SearchProps {\n  onChange: (search?: string) => void\n  defaultValue?: string\n}\n\nexport function Search({ defaultValue, onChange }: SearchProps) {\n  const debouncedSearch = debounce(\n    (searchTerm?: string) => onChange(searchTerm),\n    {\n      wait: 500, // Wait 500ms after last keystroke\n    },\n  )\n\n  function handleChange(event: React.ChangeEvent<HTMLInputElement>) {\n    const value = event.target.value\n    debouncedSearch(value.length > 0 ? value : undefined)\n  }\n  return (\n    <input\n      name=\"search\"\n      type=\"search\"\n      placeholder=\"Search books\"\n      onChange={handleChange}\n      defaultValue={defaultValue}\n    />\n  )\n}\n","import { createFileRoute, Outlet } from \"@tanstack/react-router\"\nimport { BookEntry } from \"@/components/BookEntry\"\nimport { PaginatorButtons } from \"@/components/Paginator\"\nimport { Search } from \"@/components/Search\"\nimport { BookSchemaRequest } from \"@/schemas/bookRequest\"\nimport { fetchBooks } from \"@/services/api/books\"\n\nexport const Route = createFileRoute(\"/books\")({\n  validateSearch: BookSchemaRequest,\n  loaderDeps: ({ search: { search, page } }) => ({ search, page }),\n  loader: async ({ deps: { search, page } }) => fetchBooks({ search, page }),\n  component: App,\n  errorComponent: ({ error }) => (\n    <mark>\n      There was an error: <code>{error.message}</code>\n    </mark>\n  ),\n})\n\nfunction App() {\n  const { results, count } = Route.useLoaderData()\n  const { search, page } = Route.useSearch()\n  const navigate = Route.useNavigate()\n\n  function handlePageChange(page: number): void {\n    navigate({ search: (prev) => ({ ...prev, page }) })\n  }\n\n  return (\n    <>\n      <Search\n        onChange={(search) =>\n          navigate({ search: (prev) => ({ ...prev, search, page: 1 }) })\n        }\n        defaultValue={search}\n      />\n      <ol>\n        {results.map((book) => (\n          <li key={book.id}>\n            <BookEntry {...book} />\n          </li>\n        ))}\n      </ol>\n      <Outlet />\n      <PaginatorButtons\n        totalItems={count}\n        currentPage={page || 1}\n        perPage={32}\n        onPageChange={handlePageChange}\n      />\n    </>\n  )\n}\n"],"names":["BookEntry","title","authors","id","jsxs","jsx","Link","Authors","getPage","text","page","currentPage","lastPage","isDisabled","getPageNumbers","totalItems","perPage","currentPageClamped","PaginatorButtons","onPageChange","isFunction","value","parseFunctionOrValue","args","createKey","key","MockClass","_","__","EventClient","PacerEventClient","props","emitChange","event","payload","pacerEventClient","getDefaultDebouncerState","defaultOptions","Debouncer","fn","initialOptions","__privateAdd","_timeoutId","_setState","_getEnabled","_getWait","_execute","_clearTimeout","Store","newOptions","__privateGet","__privateSet","newState","state","combinedState","isPending","_didLeadingExecute","_b","_a","debounce","Search","defaultValue","onChange","debouncedSearch","searchTerm","handleChange","App","results","count","Route","useLoaderData","search","useSearch","navigate","useNavigate","handlePageChange","prev","Fragment","map","book","Outlet"],"mappings":"ybAIO,SAASA,EAAU,CAAE,MAAAC,EAAO,QAAAC,EAAS,GAAAC,GAAY,CACtD,OACEC,EAAAA,KAAC,OAAA,CAAK,UAAU,uBACd,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAK,GAAG,iBAAiB,OAAQ,CAAE,OAAQH,EAAG,SAAA,CAAS,EACrD,SAAAF,CAAA,CACH,EACAI,EAAAA,IAAC,QAAA,CACC,SAAAA,EAAAA,IAACE,EAAA,CAAQ,QAAAL,EAAkB,CAAA,CAC7B,CAAA,EACF,CAEJ,CCHA,SAASM,EACPC,EACAC,EACAC,EACAC,EACW,CACX,MAAMC,EAAaH,EAAO,GAAKA,EAAOE,GAAYF,IAASC,EAC3D,MAAO,CAAE,KAAAF,EAAM,KAAAC,EAAM,WAAAG,CAAA,CACvB,CAEO,SAASC,EAAe,CAC7B,WAAAC,EACA,YAAAJ,EACA,QAAAK,CACF,EAAgC,CAC9B,MAAMJ,EAAW,KAAK,IAAI,EAAG,KAAK,KAAKG,EAAaC,CAAO,CAAC,EACtDC,EAAqB,KAAK,IAAI,KAAK,IAAI,EAAGN,CAAW,EAAGC,CAAQ,EACtE,MAAO,CACLJ,EAAQ,KAAM,EAAGS,EAAoBL,CAAQ,EAC7CJ,EACE,IACA,KAAK,IAAIS,EAAqB,EAAG,CAAC,EAClCA,EACAL,CAAA,EAEFJ,EAAQ,GAAIS,EAAoBA,EAAoBL,CAAQ,EAC5DJ,EACE,IACA,KAAK,IAAIS,EAAqB,EAAGL,CAAQ,EACzCK,EACAL,CAAA,EAEFJ,EAAQ,KAAMI,EAAUK,EAAoBL,CAAQ,CAAA,CAExD,CCrCO,SAASM,EAAiB,CAC/B,WAAAH,EACA,YAAAJ,EACA,QAAAK,EACA,aAAAG,CACF,EAAmB,CACjB,OACEd,MAAC,MAAA,CAAI,KAAK,QACP,SAAAS,EAAe,CAAE,WAAAC,EAAY,YAAAJ,EAAa,QAAAK,CAAA,CAAS,EAAE,IACpD,CAAC,CAAE,KAAAN,EAAM,KAAAD,EAAM,WAAAI,KACbT,EAAAA,KAAC,SAAA,CAEC,QAAS,IAAMe,EAAaT,CAAI,EAChC,SAAUG,EACV,KAAK,SACL,UAAU,UAET,SAAA,CAAAJ,EAAK,WAAE,QAAA,CAAM,SAAA,CAAA,IAAEC,EAAK,GAAA,CAAA,CAAC,CAAA,CAAA,EANjB,aAAaD,CAAI,IAAIC,CAAI,EAAA,CAOhC,EAGN,CAEJ,CChCA,SAASU,EAAWC,EAAO,CACzB,OAAO,OAAOA,GAAU,UAC1B,CACA,SAASC,EAAqBD,KAAUE,EAAM,CAC5C,OAAOH,EAAWC,CAAK,EAAIA,EAAM,GAAGE,CAAI,EAAIF,CAC9C,CACA,SAASG,EAAUC,EAAK,CACtB,OAAIA,IAGA,OAAO,OAAW,KAAe,OAAO,OAAO,YAAe,WACzD,OAAO,WAAU,EAEnB,GACT,CCbA,MAAMC,CAAU,CACd,GAAGC,EAAGC,EAAI,CACV,CACA,MAAMD,EAAG,CACT,CACA,kBAAkBA,EAAG,CACrB,CACA,KAAKA,KAAMC,EAAI,CACf,CACA,aAAc,CACd,CACF,CACA,MAAMC,EAA0FH,ECZhG,MAAMI,UAAyBD,CAAY,CACzC,YAAYE,EAAO,CACjB,MAAM,CACJ,SAAU,QACV,MAAOA,GAAA,YAAAA,EAAO,KACpB,CAAK,CACH,CACF,CACA,MAAMC,EAAa,CAACC,EAAOC,IAAY,CACrCC,EAAiB,KAAKF,EAAOC,CAAO,CACtC,EACMC,EAAmB,IAAIL,ECT7B,SAASM,GAA2B,CAClC,MAAO,CACL,kBAAmB,GACnB,eAAgB,EAChB,UAAW,GACX,SAAU,OACV,OAAQ,OACR,kBAAmB,CACvB,CACA,CACA,MAAMC,EAAiB,CACrB,QAAS,GACT,QAAS,GACT,SAAU,GACV,KAAM,CACR,kBACA,MAAMC,CAAU,CACd,YAAYC,EAAIC,EAAgB,CAiGhCC,EAAA,KAAAC,GACAD,EAAA,KAAAE,GACAF,EAAA,KAAAG,GACAH,EAAA,KAAAI,GACAJ,EAAA,KAAAK,GACAL,EAAA,KAAAM,GArGE,KAAK,GAAKR,EACV,KAAK,MAAQ,IAAIS,EACfZ,EAAwB,CAC9B,EACI,KAAK,WAAca,GAAe,CAChC,KAAK,QAAU,CAAE,GAAG,KAAK,QAAS,GAAGA,CAAU,EAC1CC,EAAA,KAAKN,GAAL,YACH,KAAK,OAAM,CAEf,EACAO,EAAA,KAAKR,EAAaS,GAAa,CAC7B,KAAK,MAAM,SAAUC,GAAU,CAC7B,MAAMC,EAAgB,CACpB,GAAGD,EACH,GAAGD,CACb,EACc,CAAE,UAAAG,CAAS,EAAKD,EACtB,MAAO,CACL,GAAGA,EACH,OAASJ,EAAA,KAAKN,GAAL,WAAkCW,EAAY,UAAY,OAArC,UACxC,CACM,CAAC,EACDvB,EAAW,YAAa,IAAI,CAC9B,GACAmB,EAAA,KAAKP,EAAc,IACV,CAAC,CAACtB,EAAqB,KAAK,QAAQ,QAAS,IAAI,GAE1D6B,EAAA,KAAKN,EAAW,IACPvB,EAAqB,KAAK,QAAQ,KAAM,IAAI,GAErD,KAAK,aAAe,IAAIC,IAAS,CAC/B,GAAI,CAAC2B,EAAA,KAAKN,GAAL,WAAoB,OACzBM,EAAA,KAAKP,GAAL,UAAe,CACb,kBAAmB,KAAK,MAAM,MAAM,kBAAoB,CAChE,GACM,IAAIa,EAAqB,GACrB,KAAK,QAAQ,SAAW,KAAK,MAAM,MAAM,oBAC3CN,EAAA,KAAKP,GAAL,UAAe,CAAE,kBAAmB,EAAK,GACzCa,EAAqB,GACrBN,EAAA,KAAKJ,GAAL,UAAc,GAAGvB,IAEf,KAAK,QAAQ,UACf2B,EAAA,KAAKP,GAAL,UAAe,CAAE,UAAW,GAAM,SAAUpB,IAE1C2B,EAAA,KAAKR,IAAY,aAAaQ,EAAA,KAAKR,EAAU,EACjDS,EAAA,KAAKT,EAAa,WAAW,IAAM,CACjCQ,EAAA,KAAKP,GAAL,UAAe,CAAE,kBAAmB,EAAI,GACpC,KAAK,QAAQ,UAAY,CAACa,GAC5BN,EAAA,KAAKJ,GAAL,UAAc,GAAGvB,EAErB,EAAG2B,EAAA,KAAKL,GAAL,UAAe,EACpB,EACAM,EAAA,KAAKL,EAAW,IAAIvB,IAAS,SACtB2B,EAAA,KAAKN,GAAL,aACL,KAAK,GAAG,GAAGrB,CAAI,EACf2B,EAAA,KAAKP,GAAL,UAAe,CACb,eAAgB,KAAK,MAAM,MAAM,eAAiB,EAClD,UAAW,GACX,SAAU,MAClB,IACMc,GAAAC,EAAA,KAAK,SAAQ,YAAb,MAAAD,EAAA,KAAAC,EAAyBnC,EAAM,MACjC,GACA,KAAK,MAAQ,IAAM,CACb,KAAK,MAAM,MAAM,WAAa,KAAK,MAAM,MAAM,WACjD2B,EAAA,KAAKH,GAAL,WACAG,EAAA,KAAKJ,GAAL,UAAc,GAAG,KAAK,MAAM,MAAM,UAEtC,EACAK,EAAA,KAAKJ,EAAgB,IAAM,CACrBG,EAAA,KAAKR,KACP,aAAaQ,EAAA,KAAKR,EAAU,EAC5BS,EAAA,KAAKT,EAAa,QAEtB,GACA,KAAK,OAAS,IAAM,CAClBQ,EAAA,KAAKH,GAAL,WACAG,EAAA,KAAKP,GAAL,UAAe,CACb,kBAAmB,GACnB,UAAW,EACnB,EACI,EACA,KAAK,MAAQ,IAAM,CACjBO,EAAA,KAAKP,GAAL,UAAeP,IACjB,EACA,KAAK,IAAMZ,EAAUgB,EAAe,GAAG,EACvC,KAAK,QAAU,CACb,GAAGH,EACH,GAAGG,CACT,EACIU,EAAA,KAAKP,GAAL,UAAe,KAAK,QAAQ,cAAgB,CAAA,GAC5CR,EAAiB,GAAG,cAAgBF,GAAU,CACxCA,EAAM,QAAQ,MAAQ,KAAK,MAC/BiB,EAAA,KAAKP,GAAL,UAAeV,EAAM,QAAQ,MAAM,OACnC,KAAK,WAAWA,EAAM,QAAQ,OAAO,EACvC,CAAC,CACH,CAOF,CANES,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YAEF,SAASY,EAASpB,EAAIC,EAAgB,CAEpC,OADkB,IAAIF,EAAUC,EAAIC,CAAc,EACjC,YACnB,CCxHO,SAASoB,EAAO,CAAE,aAAAC,EAAc,SAAAC,GAAyB,CAC9D,MAAMC,EAAkBJ,EACrBK,GAAwBF,EAASE,CAAU,EAC5C,CACE,KAAM,GAAA,CACR,EAGF,SAASC,EAAahC,EAA4C,CAChE,MAAMZ,EAAQY,EAAM,OAAO,MAC3B8B,EAAgB1C,EAAM,OAAS,EAAIA,EAAQ,MAAS,CACtD,CACA,OACEhB,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,KAAK,SACL,YAAY,eACZ,SAAU4D,EACV,aAAAJ,CAAA,CAAA,CAGN,CCTA,SAASK,GAAM,CACb,KAAM,CAAEC,QAAAA,EAASC,MAAAA,CAAAA,EAAUC,EAAMC,cAAAA,EAC3B,CAAEC,OAAAA,EAAQ7D,KAAAA,CAAAA,EAAS2D,EAAMG,UAAAA,EACzBC,EAAWJ,EAAMK,YAAAA,EAEvB,SAASC,EAAiBjE,EAAoB,CAC5C+D,EAAS,CAAEF,OAASK,IAAU,CAAE,GAAGA,EAAMlE,KAAAA,CAAAA,EAAK,CAAI,CACpD,CAEA,OACEN,EAAAA,KAAAyE,WAAA,CACE,SAAA,CAAAxE,EAAAA,IAACuD,EAAA,CACC,SAAWW,GACTE,EAAS,CAAEF,OAASK,IAAU,CAAE,GAAGA,EAAML,OAAAA,EAAQ7D,KAAM,CAAA,EAAE,CAAI,EAE/D,aAAc6D,EAAO,EAEvBlE,MAAC,KAAA,CACE8D,SAAAA,EAAQW,OACPzE,EAAAA,IAAC,KAAA,CACC,SAAAA,MAACL,EAAA,CAAU,GAAI+E,CAAAA,CAAK,CAAA,EADbA,EAAK5E,EAEd,CACD,EACH,QACC6E,EAAA,EAAM,EACP3E,EAAAA,IAACa,EAAA,CACC,WAAYkD,EACZ,YAAa1D,GAAQ,EACrB,QAAS,GACT,aAAciE,CAAAA,CAAiB,CAAA,EAEnC,CAEJ","x_google_ignoreList":[3,4,5,6]}